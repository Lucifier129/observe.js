;(function($,window,document,undefined){'use strict';var head=document.getElementsByTagName('head')[0],observe,method={init:(function(){var init;if('create'in Object){observe=addSetter;addEvent=null;init=function(obj){var _obj,_old,key;if(!('__hasSetter'in obj)){_old={};_obj=obj;obj=Object.create(proto);for(key in _obj){_obj.hasOwnProperty(key)&&(obj[key]=_old[key]=_obj[key])}obj._old=_old;obj.__hasSetter={}}return obj}}else if('onpropertychange'in head){observe=addEvent;addSetter=null;var isIE6=navigator.userAgent.indexOf("MSIE 6.0")>0;init=function(obj){var _obj,_old,key;if(!('__hasSetter'in obj)){_old={};_obj=obj;obj=document.createElement('obj');head.appendChild(obj).parentNode.removeChild(obj);isIE6&&head.appendChild(obj);for(key in _obj){if(_obj.hasOwnProperty(key)){obj[key]=_old[key]=_obj[key]}}for(key in proto){if(proto.hasOwnProperty(key)){obj[key]=proto[key]}}obj._old=_old;obj.__hasSetter={}}return obj}}return init})(),getRandomStr:function(){return Math.random().toString(36).substr(2)}},proto={add:function(key,value){this[key]=this._old[key]=value||'default value';return this},remove:(function(){return observe===addSetter?function(key){delete this[key];delete this._old[key];delete this.__hasSetter[key];return this}:function(key){this.removeAttribute(key);delete this._old[key];delete this.__hasSetter[key];return this}})(),each:function(callback){for(var key in this._old){callback.call(this,key,this[key])}return this},extend:function(src){for(var key in src){this.add(key,src[key])}return this},on:function(){var args=arguments,type=$.type(args[0]),callback,key;if(args.length===1){if(type==='object'){args=args[0];for(key in args){callback=args[key];if(typeof callback==='function'){if(!(key in this)&&!(key.split('.')[0]in this)){this.add(key)}observe(this,key,callback)}}}else if(type==='function'){callback=args[0];for(key in this._old){observe(this,key,callback)}}}else if(args.length===2){key=args[0];callback=args[1];if(type==='string'&&typeof callback==='function'){if(!(key in this)&&!(key.split('.')[0]in this)){this.add(key)}observe(this,key,callback)}}return this},off:function(){var args=arguments,key,len,i;if(!args.length){this.__hasSetter={}}else{for(i=0,len=args.length;i<len;i+=1){key=args[i];if(typeof key==='string'){if(key.indexOf('.')!==-1){if(key.indexOf('.')===0){key=key.replace(/\./g,'');for(var prop in this.__hasSetter){key in this.__hasSetter[prop]&&delete this.__hasSetter[prop][key]}}else{key=key.split('.');key[1]in this.__hasSetter[key[0]]&&delete this.__hasSetter[key[0]][key[1]]}}else if(key in this.__hasSetter){delete this.__hasSetter[key]}}}}return this}};function addSetter(obj,prop,callback){var name=prop.split('.'),value;prop=name[0];name=name[1];if(!(prop in obj.__hasSetter)){value=obj[prop];obj.__hasSetter[prop]={};Object.defineProperty(obj,prop,{set:function(v){value=v;if(prop in this.__hasSetter){for(var key in this.__hasSetter[prop]){this.__hasSetter[prop][key].call(this,prop,v)}}},get:function(){return value}})}obj.__hasSetter[prop][name||'observe-'+method.getRandomStr()]=callback;return obj}function addEvent(obj,prop,callback){var name=prop.split('.');prop=name[0];name=name[1];prop in obj.__hasSetter||(obj.__hasSetter[prop]={});obj.__hasSetter[prop][name||'observe-'+method.getRandomStr()]=callback;if(!obj.onpropertychange){obj.onpropertychange=function(e){var prop=(e||window.event).propertyName;if(prop in this.__hasSetter){for(var key in this.__hasSetter[prop]){this.__hasSetter[prop][key].call(this,prop,this[prop])}}}}return obj}window.$=function(){var args=arguments;return args.length===1&&jQuery.isPlainObject(args[0])?method.init.apply(null,args):jQuery.apply(null,args)};jQuery.extend(true,window.$,jQuery)})(jQuery,window,document);
